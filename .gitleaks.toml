# Gitleaks Configuration
# Customize what files/directories to scan and ignore

# Allow list (false positives)
[allowlist]
description = "Allow specific patterns"
paths = [
  '''test/fixtures/secrets/*''',
  '''node_modules/*''',
  '''vendor/*''',
]

# Exclude list (files/directories to skip)
[exclude]
description = "Exclude specific paths"
paths = [
  '''node_modules''',
  '''vendor''',
  '''bower_components''',
  '''package-lock.json''',
  '''composer.lock''',
  '''npm-debug.log''',
  '''yarn-error.log''',
  '''coverage''',
]

# Git-specific options
[git]
# Stop at first leak
stop-on-leak = false

# Report format (options: json, sarif, csv)
[report]
report-format = "json"
output-file = "gitleaks-report.json"

# Regex patterns for common secrets
[[rules]]
description = "Generic API Key"
regex = '''(api[_-]?key[\"'`:=,\s]+[a-z0-9]{32,})'''

[[rules]]
description = "AWS Access Key"
regex = '''(AKIA[0-9A-Z]{16})'''

[[rules]]
description = "GitHub Token"
regex = '''(gh[pousr]_[0-9a-zA-Z]{36})'''

[[rules]]
description = "Private Key"
regex = '''(-----BEGIN ((RSA|EC|OPENSSH|DSA) )?PRIVATE KEY-----)'''
