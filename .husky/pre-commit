#!/bin/sh
. "$(dirname -- "$0")/_/husky.sh"

# Check for secrets with git leaks
# Note: To enable git leaks, download the binary from:
# https://github.com/gitleaks/gitleaks/releases
# Extract and place gitleaks.exe in your PATH, then uncomment below:
#
# echo "ğŸ” Running git leaks..."
# git leaks detect --report-format json || {
#   echo "âŒ Git leaks detected secrets! Commit aborted."
#   exit 1
# }

# Run Laravel Pint on backend files if any PHP files changed
if git diff --cached --name-only | grep -E '.*\.php$'; then
  echo "ğŸ¨ Running Laravel Pint..."
  cd servetrack-backend
  ./vendor/bin/pint
  cd ..
  echo "âœ… Pint formatted files, adding to commit..."
  git add servetrack-backend/
fi

echo "âœ… Pre-commit checks passed!"
